---
layout: post
title: 'Tinkering with Twitter: Post a Tweet Using Twitter4J to interact the Twitter
  REST API endpoint'
date: '2017-11-04T16:29:00.001-04:00'
author: T.J. Maher
tags:
- Twitter
- Rest API
modified_time: '2017-11-04T16:35:55.587-04:00'
thumbnail: https://2.bp.blogspot.com/-81nFHqPn4WM/Wf3bpDtI-rI/AAAAAAAAMIo/rOPtYan5Z1ACcMGaFKC575Mp8fnRQVA2wCLcBGAs/s72-c/tweet_worked.png
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-7456240698191339515
blogger_orig_url: http://www.tjmaher.com/2017/11/tinkering-with-twitter-4.html
---

<i>This is Part Four of a multi-part blog series on putting together a basic API test framework for the Twitter Search API.&nbsp;<a href="http://www.tjmaher.com/2017/10/tinkering-with-twitter-1.html" target="_blank">Care to go back to the beginning</a>?&nbsp;</i><br /><i><br /></i>Now that we have been <a href="http://www.tjmaher.com/2017/10/tinkering-with-twitter-1.html" target="_blank">introduced to Twitter4J</a>, a Java library built to interacts with Twitter's API,&nbsp;<a href="http://www.tjmaher.com/2017/10/tinkering-with-twitter-2_29.html" target="_blank">set up credentials</a> that authorized Twitter4J to use our test Twitter account, and <a href="http://www.tjmaher.com/2017/11/tinkering-with-twitter-3.html" target="_blank">installed the Twitter4J library in a Java project</a>, we can start writing code that can do three things:<br /><br /><ul><li>Connects to the REST endpoint of the Twitter API.</li><li>Posts a Tweet to the Twitter account we set up.&nbsp;</li><li>Examine how Twitter4J interacts with the Twitter API</li></ul>To figure out how everything works, we can view:<br /><br /><ul><li><a href="http://twitter4j.org/en/code-examples.html" target="_blank">Code examples</a> on the Twitter4J official site which tells you how to post a tweet (<a href="http://twitter4j.org/en/code-examples.html#updatingStatus" target="_blank">updateStatus</a>) and search for tweets (<a href="http://twitter4j.org/en/code-examples.html#search" target="_blank">search</a>).</li><li>The <a href="http://twitter4j.org/javadoc/" target="_blank">Twitter4J javadocs</a>, more detailed documentation of how you can interact with the various classed set up.&nbsp;</li><li>The source code in the <a href="https://github.com/yusuke/twitter4j" target="_blank">Twitter4J GitHub repository</a>.</li><li>Compare the Java code you see with explanations in the <a href="https://docs.oracle.com/javase/tutorial/" target="_blank">official Java Tutorials</a>.</li><li>Lastly, review the docs for the <a href="https://developer.twitter.com/en/docs/tweets/post-and-engage/overview" target="_blank">Post and Engage Twitter using the API</a>.</li></ul><br /><a name='more'></a><br /><br />To truly know how a Java library truly works, don't expect to go to any official site to have everything spelled out. Dive into t<a href="http://twitter4j.org/javadoc/" target="_blank">he JavaDocs</a>. Feeling more advanced? Dive right into the source code and start swimming.<br /><br /><h2>Post a Tweet To Your Twitter Account: Creating Sample Code</h2>What if we wanted to create a post that:<br /><br /><ul><li>Announces in a Twitter post that we are testing Twitter4J, posting to Twitter programmatically.&nbsp;</li><li>Tags the official Twitter4J account,&nbsp;@t4j_news</li><li>Includes the link to Twitter4J documentation.</li></ul><br />Let's create a Java class to hold our tests:<br /><br /><ul><li>Go to the File menu in IntelliJ, and go to File -&gt; New -&gt; Java class.</li><li>Name it TwitterPostsAndSearchTest, and hit OK.&nbsp;</li><li>Copy and paste the sample code I created, below, into the new class we created:</li></ul>The sample code I created based off of <a href="http://twitter4j.org/en/code-examples.html" target="_blank">Twitter4J's code examples</a>.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> import org.testng.annotations.Test;  <br /> import twitter4j.*;  <br /><br /> public class TwitterPostsAndSearchTest {  <br />   @Test  <br />   public void test_postToTwitterUsingTwitter4J() throws TwitterException {  <br />     Twitter twitter = TwitterFactory.getSingleton();  <br />     String message="Testing Twitter4J, posting to Twitter programatically."  <br />                + " @t4j_news http://twitter4j.org/en/";  <br />     Status status = twitter.updateStatus(message);  <br />     System.out.println("Successfully updated the status to [" + status.getText() + "].");  <br />   }  <br /> }  <br /></code></pre><br /><i>Feel free to review the code for this test in my project,&nbsp;<a href="https://github.com/tjmaher/tinkeringWithTwitter/blob/master/src/test/java/TwitterPostsAndSearchTest.java" target="_blank">tinkeringWithTwitter, published on GitHub</a>.</i><br /><br /><h3>Deciphering the Java Code:</h3><br /><br /><div><b><u>Step 1:</u></b></div><ul><li>Import into this Java class the&nbsp;<b>@Test</b>&nbsp;annotation supplied by TestNG, a framework that kicks off individual tests. We are also importing Twitter4J.</li><li><i>Go to <a href="http://testng.org/doc/">TestNG's documentation</a>&nbsp;to read more information.</i></li></ul><b><u>Step 2:</u></b><br /><ul><li>We declare&nbsp; a new public class, TwitterPostsAndSearchTest.</li><li><i>Read more about <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/classes.html" target="_blank">Java Classes in the Java Tutorials</a>.</i></li></ul><b><u>Step 3:</u></b><br /><div><ul><li>Create a new public test method, annotating it with the&nbsp;<b>@Test annotation</b>, signifying that this will be a test.&nbsp;</li><li>Does something go wrong? We want to be able to see any errors returned to us by Twitter4J's special <b>TwitterException</b> class.</li></ul><div>... If you review the <a href="http://twitter4j.org/javadoc/twitter4j/TwitterException.html" target="_blank">TwitterException class listed in Twitter4J's Javadocs</a>, you can see that it tests for:</div><div><ul><li>Rate limit errors: Twitter sets a rate limit on just how many tweets can be automatically sent in a certain period of time. If the rate limit is exceeded, the Twitter API will return a digit representing how many seconds you need to wait to retry the action again.&nbsp;</li><li>Network issues.</li><li>If the REST API we are looking for is not found.&nbsp;</li></ul></div><div><b><u>Step 4:&nbsp;</u></b></div><ul><li>Declare a new instance of Twitter4J's Twitter class, setting up one single instance using Twitter4J's Twitter Factory class.</li><li><i>Advanced Reading: The Singleton design pattern at <a href="https://sourcemaking.com/design_patterns/singleton" target="_blank">Design Patterns Explained Simply</a>.</i></li></ul><div><b><u>Step 5:</u></b></div><div><ul><li>Set up the message we wish to send, storing it in a Java String we are calling "message".</li></ul></div><b><u>Step 6:</u></b></div><div><ul><li>Use Twitter4J's pre-defined method "updateStatus", passing in the message string we set up. Grab the status message that updateStatus returns.</li></ul><div><b><u>Step 7:</u></b>&nbsp;</div><ul><li>Finally, print out what was was received back to us.</li></ul><br /><br /><h2>How to Run The Test</h2><br /><ul><li>In the code block for the test, right click.</li><li>Select 'Run test_postToTwitterUsingTwitter4J'</li><li>Review the debug messages for errors. Check if there is a success message printed.</li><li>Go to <a href="http://twitter.com/" target="_blank">http://twitter.com/</a>, logging into your account, to see if the message is posted.&nbsp;</li></ul><br />If everything is successful, you should see an image like the one below:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-81nFHqPn4WM/Wf3bpDtI-rI/AAAAAAAAMIo/rOPtYan5Z1ACcMGaFKC575Mp8fnRQVA2wCLcBGAs/s1600/tweet_worked.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="232" data-original-width="586" src="https://2.bp.blogspot.com/-81nFHqPn4WM/Wf3bpDtI-rI/AAAAAAAAMIo/rOPtYan5Z1ACcMGaFKC575Mp8fnRQVA2wCLcBGAs/s1600/tweet_worked.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i>We just posted a tweet using the Twitter API!</i></td></tr></tbody></table><br />... Where did that cute icon come from?<br /><br />That is what is called a "Twitter Card". View the Twitter documentation for the "Card Display" at&nbsp;<a href="https://developer.twitter.com/en/docs/tweets/optimize-with-cards/guides/getting-started" target="_blank">https://developer.twitter.com/en/docs/tweets/optimize-with-cards/guides/getting-started</a><br /><br />This summary card is created right off of the meta keywords the website developer uses to describe the site, using whatever images are set up. Read the article "<a href="https://moz.com/blog/meta-data-templates-123" target="_blank">Must-Have Social Meta Tags for Twitter, Google+, Facebook and More</a>".<br /><br /><h2>What Do The Log Files Mean?</h2>Because we have in our Twitter4J.Properties file the debug flag set to "true", we see the below output:<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> [Sat Nov 04 11:07:19 EDT 2017]serialVersionUID: 6175546394599249696  <br /> [Sat Nov 04 11:07:19 EDT 2017]debug: true  <br /> [Sat Nov 04 11:07:19 EDT 2017]user: null  <br /> [Sat Nov 04 11:07:19 EDT 2017]password: null  <br /> [Sat Nov 04 11:07:19 EDT 2017]httpConf: MyHttpClientConfiguration{httpProxyHost='null', httpProxyUser='null', httpProxyPassword='null', httpProxyPort=-1, httpConnectionTimeout=20000, httpReadTimeout=120000, prettyDebug=false, gzipEnabled=true}  <br /> [Sat Nov 04 11:07:19 EDT 2017]httpStreamingReadTimeout: 40000  <br /> [Sat Nov 04 11:07:19 EDT 2017]httpRetryCount: 0  <br /> [Sat Nov 04 11:07:19 EDT 2017]httpRetryIntervalSeconds: 5  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthConsumerKey: {HIDDEN}  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthConsumerSecret: **************************************************  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthAccessToken: {HIDDEN}  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthAccessTokenSecret: *********************************************  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuth2TokenType: null  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuth2AccessToken: null  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuth2Scope: null  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthRequestTokenURL: https://api.twitter.com/oauth/request_token  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthAuthorizationURL: https://api.twitter.com/oauth/authorize  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthAccessTokenURL: https://api.twitter.com/oauth/access_token  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuthAuthenticationURL: https://api.twitter.com/oauth/authenticate  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuth2TokenURL: https://api.twitter.com/oauth2/token  <br /> [Sat Nov 04 11:07:19 EDT 2017]oAuth2InvalidateTokenURL: https://api.twitter.com/oauth2/invalidate_token  <br /></code></pre><br />But what does it all mean?<br /><b><br /></b><b>Collect the Properties We Need to Pass to the API:</b><br />1) We start collecting the properties we need to before interacting with Twitter's REST endpoint, such as the OAUTH tokens we are attempting to use to become authorized to use the endpoint:<br /><br /><ul><li>serialVersionUID: 6175546394599249696</li><li>debug: true</li><li>httpConf: MyHttpClientConfiguration{httpProxyHost='null', httpProxyUser='null', httpProxyPassword='null', httpProxyPort=-1, httpConnectionTimeout=20000, httpReadTimeout=120000, prettyDebug=false, gzipEnabled=true}</li><li>httpStreamingReadTimeout: 40000</li><li>httpRetryCount: 0</li><li>httpRetryIntervalSeconds: 5</li><li>oAuthConsumerKey: {HIDDEN}</li><li>oAuthConsumerSecret: **************************************************</li><li>oAuthAccessToken: {HIDDEN}</li><li>oAuthAccessTokenSecret: *********************************************</li><li>oAuth2TokenType: null</li><li>oAuth2AccessToken: null</li><li>oAuth2Scope: null</li></ul><br /><br />2) It creates a list of Twitter endpoints we can interact with using Twitter4J:<br /><br /><ul><li>oAuthRequestTokenURL: https://api.twitter.com/oauth/request_token</li><li>oAuthAuthorizationURL: https://api.twitter.com/oauth/authorize</li><li>oAuthAccessTokenURL: https://api.twitter.com/oauth/access_token</li><li>oAuthAuthenticationURL: https://api.twitter.com/oauth/authenticate</li><li>oAuth2TokenURL: https://api.twitter.com/oauth2/token</li><li>oAuth2InvalidateTokenURL: https://api.twitter.com/oauth2/invalidate_token</li><li>restBaseURL: https://api.twitter.com/1.1/</li><li>streamBaseURL: https://stream.twitter.com/1.1/</li><li>userStreamBaseURL: https://userstream.twitter.com/1.1/</li><li>siteStreamBaseURL: https://sitestream.twitter.com/1.1/</li><li>uploadBaseURL: https://upload.twitter.com/1.1/</li><li>dispatcherImpl: twitter4j.DispatcherImpl</li></ul><br /><br />3) How many tests do we want to run at once? Do we want to include how many people retweeted a post?<br /><br /><ul><li>asyncNumThreads: 1</li><li>loggerFactory: null</li><li>contributingTo: -1</li><li>includeMyRetweetEnabled: true</li><li>includeEntitiesEnabled: true</li><li>trimUserEnabled: false</li><li>includeExtAltTextEnabled: true</li><li>tweetModeExtended: false</li><li>includeEmailEnabled: false</li><li>jsonStoreEnabled: false</li><li>mbeanEnabled: false</li><li>userStreamRepliesAllEnabled: false</li><li>userStreamWithFollowingsEnabled: true</li></ul><br /><br />4) It then catalogs all the various configurations:<br /><br /><ul><li>instances: [ConfigurationBase{debug=true, user='null', password='null', httpConf=MyHttpClientConfiguration{httpProxyHost='null', httpProxyUser='null', httpProxyPassword='null', httpProxyPort=-1, httpConnectionTimeout=20000, httpReadTimeout=120000, prettyDebug=false, gzipEnabled=true}, httpStreamingReadTimeout=40000, httpRetryCount=0, httpRetryIntervalSeconds=5 [...]</li></ul><br /><br />5) Since we are using the updateStatus method, The REST API Endpoint that Twitter4J will hit for us using /statuses/update.json<br /><br /><ul><li>Request:&nbsp;</li><li>POST https://api.twitter.com/1.1/statuses/update.json</li><li>[Sat Nov 04 11:07:19 EDT 2017]OAuth base string: POST&amp;https%3A%2F%2Fapi.twitter.com%2F1.1%2Fstatuses%2Fupdate.json&amp;include_entities%3Dtrue%26include_ext_alt_text%3Dtrue%26oauth_consumer_key....</li></ul><br /><br />6) Everything is sent in as a big long URL: Properties, the message, everything:<br /><br /><ul><li>%3DBGI2N94oM0r8ceJ7MW3ippBGT%26oauth_nonce%%26oauth_signature_method%3%26oauth_timestamp%%26oauth_token%%26oauth_version%3D1.0%26status%3DTesting%2520Twitter4J%252C%2520posting%2520to%2520Twitter%2520programatically.%2520%2540t4j_news%2520http%253A%252F%252Ftwitter4j.org%252Fen%252F</li></ul><br />7) Twitter4J announces itself as the Twitter client you are using:<br /><br /><ul><li>X-Twitter-Client-Version: 4.0.6</li><li>X-Twitter-Client-URL: http://twitter4j.org/en/twitter4j-4.0.6.xml</li><li>X-Twitter-Client: Twitter4J</li><li>User-Agent: twitter4j http://twitter4j.org/ /4.0.6</li><li>Accept-Encoding: gzip</li><li>Post Params: status=Testing%20Twitter4J%2C%20posting%20to%20Twitter%20programatically.%20%40t4j_news%20http%3A%2F%2Ftwitter4j.org%2Fen%2F&amp;include_entities=true&amp;include_ext_alt_text=true</li></ul><br />8) The information is sent to the Twitter API, and we received an OK - Success message back!<br /><br /><ul><li>HTTP/1.1 200 OK</li></ul><br /><br />Then, the message we have been looking for prints out:<br /><br /><b>Successfully updated the status to [Testing Twitter4J, posting to Twitter programatically. @t4j_news https://t.co/yH9nCIPnfu].</b><br /><br /><br />While you are on Twitter, drop me a line and say hello! I am&nbsp;<a href="https://twitter.com/tjmaher1" target="_blank">@tjmaher1</a>.<br /><br />With our next entry, we will be talking about how to use the Twitter Search API.<br /><br />Until then, Happy Testing! <br />  <div><div class="toc-section" id="toc-section"><b>Tinkering With Twitter</b><br /><ul><li><b>Part One</b>: <a href="http://www.tjmaher.com/2017/10/tinkering-with-twitter-1.html" target="_blank">Twitter and the Twitter Search API</a></li><li><b>Part Two</b>: <a href="http://www.tjmaher.com/2017/10/tinkering-with-twitter-2_29.html" target="_blank">Getting the Twitter credentials: Consumer Keys and Access Tokens</a></li><li><b>Part Three: </b><a href="http://www.tjmaher.com/2017/11/tinkering-with-twitter-3.html" target="_blank">Setting up an API Testing Environment with Twitter4J</a></li><li><b>Part Four:</b> <a href="http://www.tjmaher.com/2017/11/tinkering-with-twitter-4.html" target="_blank">Post a Tweet Using Twitter4J To Interact With the Twitter API</a></li><li><b>GitHub</b>: <a href="https://github.com/tjmaher/tinkeringWithTwitter/" target="_blank">Review the source code for the project</a>.</li></ul></div></div>   <br />-T.J. Maher<br /><a href="https://twitter.com/tjmaher1" style="color: #1155cc;" target="_blank">Twitter</a>&nbsp;|&nbsp;<a href="https://www.linkedin.com/in/tjmaher1" style="color: #1155cc;" target="_blank">LinkedIn</a>&nbsp;|&nbsp;<a href="https://github.com/tjmaher" style="color: #1155cc;" target="_blank">GitHub</a><br /><br /><i>// Sr. QA Engineer, Software Engineer in Test, Software Tester since 1996.<br />// Contributing Writer for&nbsp;<a href="http://techbeacon.com/contributors/thomas-maher" style="color: #1155cc;" target="_blank">TechBeacon.</a><br />// "Looking to move away from manual QA?&nbsp;Follow&nbsp;<a href="http://www.tjmaher.com/" style="color: #1155cc;" target="_blank">Adventures in Automation</a>&nbsp;on <a href="https://www.facebook.com/AdventuresInAutomation/" target="_blank">Facebook</a>!"</i></div>