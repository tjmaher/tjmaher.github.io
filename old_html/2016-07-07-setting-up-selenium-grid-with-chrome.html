---
layout: post
title: Setting Up Selenium Grid with Chrome and Firefox browser nodes from Docker-Selenium
date: '2016-07-07T01:29:00.000-04:00'
author: T.J. Maher
tags:
- SeleniumGrid
- Docker
modified_time: '2016-07-09T08:38:39.970-04:00'
thumbnail: https://4.bp.blogspot.com/-AF_oR1OvVIQ/V3yCH1sMeLI/AAAAAAAALOw/76RyyVMJZbk3iHQVEk5IXkf8wnJSJFrpgCKgB/s72-c/dockericon.png
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-3795391781966419195
blogger_orig_url: http://www.tjmaher.com/2016/07/setting-up-selenium-grid-with-chrome.html
---

<i>Please Note: This blog post will be using the official SeleniumHQ's <a href="https://github.com/SeleniumHQ/docker-selenium" target="_blank">Docker-Selenium</a> project, not Leo Gallucci's <a href="https://github.com/elgalu/docker-selenium" target="_blank">Docker-Selenium project</a></i><br /><br />We will be experimenting, in this blog post, with installing Docker,&nbsp;deploying Selenium HQ's various Chrome and Firefox Docker images, regular versions, and using them with their Docker image of Selenium Hub.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-AF_oR1OvVIQ/V3yCH1sMeLI/AAAAAAAALOw/76RyyVMJZbk3iHQVEk5IXkf8wnJSJFrpgCKgB/s1600/dockericon.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="135" src="https://4.bp.blogspot.com/-AF_oR1OvVIQ/V3yCH1sMeLI/AAAAAAAALOw/76RyyVMJZbk3iHQVEk5IXkf8wnJSJFrpgCKgB/s400/dockericon.png" width="400" /></a></div>Later on, we will tie this in with my <a href="https://github.com/tjmaher/BasicWebDriverFramework_Gradle" target="_blank">BasicWebDriverFramework_Gradle</a>, including into the project our work with <a href="http://www.tjmaher.com/2016/06/page-factories-setting-up-creating-them.html" target="_blank">PageFactories</a>, and adding RemoteWebDriver and DesiredCapabilities functionality. In the post after this, we will build on this information, using Docker Compose to scale Selenium Grid.<br /><br /><b>Docker</b>:&nbsp;<a href="https://www.docker.com/">https://www.docker.com/</a><br /><b>SeleniumHQ Images</b>:&nbsp;<a href="https://hub.docker.com/u/selenium/">https://hub.docker.com/u/selenium/</a><br /><b>Docker-Compose</b>:&nbsp;<a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a><br /><ul><li>Want to tinker a bit with setting up a virtual environment with <a href="http://www.tjmaher.com/2016/05/setting-up-virtual-dev-environment-with.html" target="_blank">VirtualBox, Vagrant, and Docker</a> first?&nbsp;</li><li>Want a practice exercise <a href="http://www.tjmaher.com/2016/07/setting-up-docker-easy-way-on-mac-or.html" target="_blank">setting up Docker</a>?</li><li>Unfamiliar with the command line? Want a practice exercise <a href="http://www.tjmaher.com/2016/07/setup-of-selenium-grid-for-beginners.html" target="_blank">setting up Selenium Grid</a>?&nbsp;</li></ul>Why install Selenium Grid in a container system like Docker? Docker is built to help make configuring systems easier, helpful if you are setting up Selenium Grid with one Selenium Hub and multiple Chrome and Firefox nodes.<br /><br />Normally, to set up Grid, you would:<br /><br /><ul><li>Download Selenium-StandAlone-Server</li><li>Start up the Selenium Hub:&nbsp;<i>java -jar selenium-server-standalone-2.53.0.jar -role hub</i></li><li>Start up various nodes:&nbsp;<i>java -jar selenium-server-standalone-2.53.0.jar -role node -hub http://localhost:4444/grid/register -browser browserName=firefox,maxInstances=2 -browser browserName=chrome,maxInstances=2</i></li></ul><div><i>... </i>Then the Selenium Grid would be ready to use at http://localhost:4444.&nbsp;</div><div><br /></div><div>With Docker, it is still that same three step process... except we can bundle all of those three steps into one with Docker Compose. That is for later blog posts. First, though, let's talk about Docker...</div><br /><br /><a name='more'></a><br /><h2>1. &nbsp;Install Docker</h2><br /><b>Docker</b> is similar to a virtual machine, but more lightweight. With a virtual machine, the operating system also needs to be included. With Docker, the Docker Engine is separate from the Docker images you can pull from <b>Docker Hub</b>&nbsp;<a href="https://hub.docker.com/">https://hub.docker.com/</a>&nbsp;running the images on your system. System errors? You can blow away the Docker image on your system and pull in a fresh image.<br /><h3><br />1.1. &nbsp;<b>Download and Install Docker Toolbox</b></h3><br />Install <b>Docker Toolbox</b>:&nbsp;<a href="https://www.docker.com/products/docker-toolbox">https://www.docker.com/products/docker-toolbox</a>. To run Docker commands, you need to run the Docker Quickstart Terminal. Check and install everything. We will need Docker Compose later, and VirtualBox needs to be installed inside Docker. Oracle's VirtualBox is bundled with the Toolbox. Note: Quickstart is NOT quick the first time around.<br /><ul><li>Docker's GitHub site:&nbsp;<a href="https://github.com/docker/docker">https://github.com/docker/docker</a></li><li>Need more info? See the Guide to <a href="http://www.tjmaher.com/2016/07/setting-up-docker-easy-way-on-mac-or.html" target="_blank">setting up Docker Toolbox</a></li></ul><br />Once it (finally) installed, you should see this: <br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-LT8S7Ui44J8/V3zp5prdbAI/AAAAAAAALPQ/IfcUkzlKFeQOtgO_TljzxtWZ9Arq74r0QCLcB/s1600/docker.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="116" src="https://3.bp.blogspot.com/-LT8S7Ui44J8/V3zp5prdbAI/AAAAAAAALPQ/IfcUkzlKFeQOtgO_TljzxtWZ9Arq74r0QCLcB/s400/docker.png" width="400" /></a></div><br />Note that Docker is configured to use your default machine with the IP Address: 192.168.99.100. <br /><h3><br />1.2. &nbsp;Verify Docker is Working</h3><br />Type in the Terminal window: <br /><ul><li>docker version</li></ul>... Hopefully, you will see information for the Docker version you are running.&nbsp; <br /><br />Want to see other Docker Commands? Go to&nbsp;<a href="https://docs.docker.com/engine/reference/commandline/cli/">https://docs.docker.com/engine/reference/commandline/cli/</a><br /><br /><h2>2. Install SeleniumHQ Docker Images&nbsp;</h2><br /><h3><b>2.1. &nbsp;Review the Images from Docker Hub</b></h3><br />The Docker images we will be installing are at&nbsp;<b>SeleniumHQ:&nbsp;</b><a href="https://hub.docker.com/u/selenium/">https://hub.docker.com/u/selenium/</a>&nbsp;... you can click on these individual images to see how you can interact with them.<br /><br />For a description of what these images do, we can go to the Selenium HQ Selenium Docker GitHub site at <a href="https://github.com/SeleniumHQ/docker-selenium">https://github.com/SeleniumHQ/docker-selenium</a>:<br /><ul><li><b>selenium/hub</b>: Image for running a Selenium Grid Hub</li><li><b>selenium/node-chrome</b>: Selenium node with Chrome installed, needs to be connected to a Selenium Grid Hub</li><li><b>selenium/node-firefox</b>: Selenium node with Firefox installed, needs to be connected to a Selenium Grid Hub</li><li><b>selenium/standalone-chrome</b>: Selenium standalone with Chrome installed</li><li><b>selenium/standalone-firefox</b>: Selenium standalone with Firefox installed</li><li><b>selenium/standalone-chrome-debug</b>: Selenium standalone with Chrome installed and runs a VNC server</li><li><b>selenium/standalone-firefox-debug</b>: Selenium standalone with Firefox installed and runs a VNC server</li><li><b>selenium/node-chrome-debug</b>: Selenium node with Chrome installed and runs a VNC server, needs to be connected to a Selenium Grid Hub</li><li><b>selenium/node-firefox-debug</b>: Selenium node with Firefox installed and runs a VNC server, needs to be connected to a Selenium Grid Hub</li></ul><br />You can build your own Docker images using the base images, run one standalone browser at a time on port 4444 with the standalone versions, use the headless versions of the browser to run the tests, or use the debug versions to see exactly what the test is doing on your screen.<br /><br /><h3><b>2.2. &nbsp;Run the Selenium/ Hub</b></h3><br /><b>2.2.1. &nbsp;Go to Docker Hub and select the Selenium/ Hub Docker image for instructions. &nbsp;</b><br /><br />Go to <b>Selenium HQ's</b> Selenium repository on the Docker Hub at <a href="https://hub.docker.com/r/selenium/">https://hub.docker.com/r/selenium/</a> and select the Docker image called "Selenium/ Hub". All Docker Images list instructions on how the image is run. More thorough information is on&nbsp;<a href="https://github.com/SeleniumHQ/docker-selenium">https://github.com/SeleniumHQ/docker-selenium</a>.<br /><br /><br /><b>2.2.2. &nbsp;Launch a container from the Docker image.</b><br /><br />To run the selenium/hub &nbsp;Docker image,&nbsp;<a href="https://hub.docker.com/r/selenium/hub/">https://hub.docker.com/r/selenium/hub/</a>&nbsp;enter the following into the Docker Terminal:<br /><pre style="background: rgb(240, 240, 240); border: 1px dashed rgb(204, 204, 204); font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; width: 646.469px;"><code style="word-wrap: normal;"> docker run -d -p 4444:4444 --name selenium-hub selenium/hub:2.53.0  </code></pre><br /><ul><li>Run a Container based on a Docker Image. If the image cannot be found, pull it down from the Docker Hub: <i>docker run</i></li><li>Start the container in detached mode, as opposed to foreground mode, so the console won't become attached to input, output, and standard error streams: <i>-d</i></li><li>Map the Host Port to the Container Port. Remember, the IP address is 192.168.99.100. Let's use HOSTPORT 4444 and CONTAINERPORT 4444: <i>-p 4444:4444</i></li><li>Set the name of the container as selenium-hub (much easier than the UUID Long and Short Identifier): <i>--name selenium-hub</i></li><li>&nbsp;Run the image called "selenium/hub" but specify a version of the image with the tag "2.53.0": <i>selenium/hub:2.53.0</i></li></ul><div>... Need more information?&nbsp;</div><div><ul><li>Examine the Dockerfile for this image at&nbsp;<a href="https://hub.docker.com/r/selenium/hub/~/dockerfile/">https://hub.docker.com/r/selenium/hub/~/dockerfile/</a> to see the default environment values set up for the Jetty server setting up the Selenium Grid.&nbsp;</li><li>See the <b>Docker Run Reference</b> at&nbsp;<a href="https://docs.docker.com/engine/reference/run">https://docs.docker.com/engine/reference/run</a></li></ul></div><br /><b>2.2.3 &nbsp;Verify the images have been installed</b><br /><br />Type into the Docker Terminal:<br /><ul><li>docker images</li></ul><b><br /></b><b>2.2.4. &nbsp;Verify that the Selenium Grid is running.</b><br /><br />Selenium Grid will be running on your local host. Go to it and make sure you are using the version of selenium-standalone-server that you designated, 2.53.0:&nbsp;<a href="http://192.168.99.100:4444/">http://192.168.99.100:4444/</a><br /><blockquote class="tr_bq">"You are using grid 2.53.0<br />"Find help on the official selenium wiki :&nbsp;<a href="https://github.com/SeleniumHQ/selenium/wiki/Grid2">more help here</a>"default monitoring page :&nbsp;<a href="http://192.168.99.100:4444/grid/console">console</a>"</blockquote>Select "console". Notice that there are no nodes yet running.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-weTeufZIXOw/V33WaHpKk3I/AAAAAAAALPo/ReQ1xbmsiJMUeOPQ-1mJcN-2VP_2eyTqQCLcB/s1600/grid%2Bno%2Bnode.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="167" src="https://1.bp.blogspot.com/-weTeufZIXOw/V33WaHpKk3I/AAAAAAAALPo/ReQ1xbmsiJMUeOPQ-1mJcN-2VP_2eyTqQCLcB/s400/grid%2Bno%2Bnode.png" width="400" /></a></div><br /><br /><h2>2.3. &nbsp;Setup Chrome and Firefox Nodes</h2><br />We are going to set up the Docker images for Chrome and Firefox, and add them to the already running Selenium Hub.<br /><b><br /></b><b>2.3.1. &nbsp;Run from the Docker Engine <i>node-chrome</i> and <i>node-firefox</i>.</b><br /><br /><b>For Chrome:</b><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker run -d --link selenium-hub:hub selenium/node-chrome:2.53.0  <br /></code></pre><br /><b>For Firefox:</b><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker run -d --link selenium-hub:hub selenium/node-firefox:2.53.0  <br /></code></pre><br /><br /><b>2.3.2. &nbsp;Verify that nodes are now set up in the Selenium Grid.</b><br /><br />Go to the Selenium Grid console, at <a href="http://192.168.99.100:4444/grid/console">http://192.168.99.100:4444/grid/console</a><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-zh4udgHiphk/V33b-mf6sII/AAAAAAAALQA/KbmI_7rNIk4Nm9MIxxVeZTIGPWxhlmyegCLcB/s1600/grid%2Bnode.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="196" src="https://2.bp.blogspot.com/-zh4udgHiphk/V33b-mf6sII/AAAAAAAALQA/KbmI_7rNIk4Nm9MIxxVeZTIGPWxhlmyegCLcB/s640/grid%2Bnode.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i>Congratulations, it's a Grid Console!</i></td></tr></tbody></table>You will be able to connect to this Selenium Grid just as if it were running on your local machine instead of in a container.<br /><br />Ignore the "Remote Control" instance of each browser. That is used in Selenium RC.<br /><br />Hover your cursor over the browser instances in your "WebDriver" sections. You can see what you can set up in RemoteWebDriver for Desired Capabilities:<br /><br /><ul><li>browserName: "chrome" or "firefox".</li><li>maximum numbers of instances that can run: 1</li><li>platform: LINUX.</li></ul><div>You can easily scale up or down the number of instances. Don't scale up to more than you think you might need... each instance of a browser running on your machine chews up a lot of memory! &nbsp;</div><div><br /></div><br />WARNING! These Docker images are not meant to be like virtual machines, always running in the background.<br /><br /><i>"Note: Since a Docker container is not meant to preserve state and spawning a new one takes less than 3 seconds you will likely want to remove containers after each end-to-end test with --rm command. You need to think of your Docker containers as single processes, not as running virtual machines." -<a href="https://github.com/SeleniumHQ/docker-selenium" target="_blank">Docker-Selenium, GitHub</a></i><br /><br /><h2>2.4. Future plans.</h2><br /><br /><h3>2.4.1.  Scaling Selenium Grid</h3><br />Next blog post, we will look at using <b>Docker Compose</b>&nbsp;at <a href="https://docs.docker.com/compose/overview/">https://docs.docker.com/compose/overview/</a> to set up a YAML (*.yml) file, so we can easily bring up all hubs and nodes, spin up more nodes, or stop all services, all with one command line... and a lengthy configuration file.&nbsp; <br /><br /><h3>2.4.2.  RemoteWebDriver and DesiredCapabilities</h3><br />Following that, we will be finally adding RemoteWebDriver and DesiredCapabilities to finally, after all the work we have done to prepare for Docker-Selenium, hook up our browser tests up with the Selenium Grid.  <br /><br />Rough Test to Demonstrate Docker-Selenium Hookups:<br /><pre class="brush: java">@Test<br />public void test_FirefoxDockerGridNavigatesToLoginPage() throws Exception  {<br />   DesiredCapabilities capabilities = DesiredCapabilities.firefox();<br />   capabilities.setBrowserName("firefox");<br />   capabilities.setPlatform(Platform.LINUX);<br />   driver = new RemoteWebDriver(new URL("http://192.168.99.100:4444/wd/hub"), capabilities);<br />   driver.get("http://the-internet.herokuapp.com/login");<br />   assertThat(driver.getTitle(), is(equalTo("The Internet")));<br />}<br /></pre><br />... If you run this individual test, it takes the DesiredCapabilities, and attempts to find a node at whatever URL you give it to run the test. Here, we have listed the Linux version of Firefox, what we have listed as a property of our WebDriver instance of Firefox. <br /><h2>2.5. &nbsp;Docker Commands</h2><br /><b>See Docker images:</b> Want to see what Docker images you have on your system?  <br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker images  <br /></code></pre><b><br /></b><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-DIbfUrpQsok/V33h8rUZnII/AAAAAAAALQY/SxonuBJKWgwIJD9cmmlKlUrMrFGg1xuIACLcB/s1600/docker%2Bimages.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="73" src="https://2.bp.blogspot.com/-DIbfUrpQsok/V33h8rUZnII/AAAAAAAALQY/SxonuBJKWgwIJD9cmmlKlUrMrFGg1xuIACLcB/s640/docker%2Bimages.png" width="640" /></a></div><br /><b>See Running Containers</b>: Show us only Docker containers that are currently running:<br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker ps  <br /></code></pre><br /><b>See ALL containers</b>: Show us ALL of the Docker containers, even those not running.<br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker ps -a  <br /></code></pre><br /><b>Logs:</b> Want to see the log files of selenium-hub? <i>(Reference: <a href="https://docs.docker.com/engine/reference/commandline/logs/" target="_blank">logs</a>)</i><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker logs -f selenium-hub  <br /></code></pre><br />... Make sure to CTRL-C out of the logfile.  <br /><br /><b>Stop an individual container</b>, like selenium-hub, from running <i>(Reference: <a href="https://docs.docker.com/engine/reference/commandline/stop/" target="_blank">stop</a>)</i>:<br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker stop selenium-hub  <br /></code></pre><br /><b>Stop ALL containers</b> from running:<br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker stop $(docker ps -a -q)  <br /></code></pre><br /><b>Get help:</b><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker help  <br /></code></pre><br /><b>Get help on a command</b>, such as "ps":<br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker help --ps  <br /></code></pre><br /><b>Remove the Docker image</b>, selenium-hub, after stopping the container from running&nbsp;<i>(Reference: <a href="https://docs.docker.com/engine/reference/commandline/rmi/" target="_blank">rmi</a>):</i><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> docker rmi selenium-hub  <br /></code></pre><br /><br /><h2>Coming Up...</h2>Future blog posts will cover:<br /><br /><ul><li><b>RemoteWebDriver: </b>Taking our <a href="https://github.com/SeleniumHQ/selenium/wiki/DesiredCapabilities" target="_blank">DesiredCapabilities</a> we touched upon, and expand it.&nbsp;</li><li><b>Docker Compose</b>:&nbsp;<a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a>: Bundle together scaling up or down Selenium Grid browser nodes, downloading Selenium Grid, starting up a Hub, and starting up various nodes.</li><li><b>MicrosoftWebDriver</b>: ( <a href="https://www.microsoft.com/en-us/download/details.aspx?id=48212" target="_blank">Link</a> ): How to incorporate Microsoft Edge into your tests.</li><li><b>Microsoft Virtual Images</b>: <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/">https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/</a>&nbsp;add IE8, IE9, IE10, IE11 on Windows 7 or IE 11 and Microsoft Edge to Windows 10 nodes to your Selenium Hub! Just use VirtualBox, Vagrant, HyperV (Windows), VMWare, or Parallels (Mac). Take a snapshot of the images because the originals are only good for 90 days.&nbsp;</li><li><b>Selenium Grid Extras</b>:&nbsp;<a href="https://github.com/groupon/Selenium-Grid-Extras">https://github.com/groupon/Selenium-Grid-Extras</a></li></ul><br /><br />Until the next time I find four spare hours to research and write up more documentation... Happy Testing! <br /><br />-T.J. Maher<br />Sr. QA Engineer, <br />Fitbit-Boston<br /><br /><i>// BSCS, MSE, and QA Engineer since Aug. 1996 <br />// Automation developer for [ 1.5 ] years and still counting!<br />// Check out Adventures in Automation and Like us on <a href="https://www.facebook.com/AdventuresInAutomation/">Facebook</a>! </i>