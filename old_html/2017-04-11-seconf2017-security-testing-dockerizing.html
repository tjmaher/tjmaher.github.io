---
layout: post
title: 'SeConf2017: Security Testing, Dockerizing Tests using Appium, Notes'
date: '2017-04-11T08:00:00.000-04:00'
author: T.J. Maher
tags:
- appium
modified_time: '2017-04-17T08:17:09.680-04:00'
thumbnail: https://i.ytimg.com/vi/3k922FTnGb8/default.jpg
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-8072465295451645790
blogger_orig_url: http://www.tjmaher.com/2017/04/seconf2017-security-testing-dockerizing.html
---

<b>Security Test Driven Development (STDD) Using Selenium / Appium</b><br />Surendran Ethiraj<br /><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/3k922FTnGb8" width="560"></iframe><br /><a href="https://youtu.be/3k922FTnGb8">https://youtu.be/3k922FTnGb8</a><br /><br />Although many people think security testing is important, there aren’t many people implementing it sprint-by-sprint. To really help, security tests need to be easy to run, and they should be automated. Security should be in the DEV cycle, not waiting until the product is done.<br /><br /><b>Slides</b>: <a href="https://www.slideshare.net/ATASlides/atagtr2017-security-test-driven-development-stdd">https://www.slideshare.net/ATASlides/atagtr2017-security-test-driven-development-stdd</a><br /><br />Surendran is using OWASP ZAP (the <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project" target="_blank">Zed Attack Proxy</a> Project ) , FindBugs, and TestNG to set up security tests in the video.<br /><br /><a name='more'></a><br /><br /><br /><b>FindBugs,&nbsp;</b>a project out of University of Maryland,<b>&nbsp;</b>uses static analysis to look for bugs in Java code.<br /><br /><ul><li><b>Eclipse</b>: Plugin  <a href="https://github.com/findbugsproject/findbugs">https://github.com/findbugsproject/findbugs</a>&nbsp;</li><li><b>IntelliJ</b>: FindBugs-IDEA <a href="https://plugins.jetbrains.com/plugin/3847-findbugs-idea">https://plugins.jetbrains.com/plugin/3847-findbugs-idea</a>&nbsp;</li></ul><br />ZAP is used as a proxy, but you can use <a href="https://portswigger.net/burp/" target="_blank">BurpSuite</a>, <a href="https://www.wireshark.org/" target="_blank">WireShark</a>, etc. <br /><br />Surendran demoed a Jenkins project, he created called Project STDD. Code is deployed locally using Tomcat. Tests are run from Maven.<br /><br />Note: ZAP can give you false positives. They thought of: What is more important? Detecting cross-site scripting? Or X-Frames? They filter what bugs they want to find.<br /><br />Using <a href="http://en.soft-xpansion.eu/" target="_blank">XPansion</a> after running the job can be shown so you can submit bugs directly to developers.<br /><br /><ul><li>You can also see the complete ZAP report.</li><li>You cannot find Cross Site Scripting until you add Dynamic Testing.</li><li>Some of theses tools can be used on not just the web and Selenium, but with mobile and Appium.</li></ul><br /><br />ZAP is a good starting point. It is updated every three years, testing for the OWASP Top Ten. He recommends moving on from there to Wireshark.<br /><br />For Forensic Analysis, use <a href="https://www.splunk.com/" target="_blank">Splunk</a> as a a tool, to see if there are any passwords getting leaked.<br /><br /><br /><b>Test Inside Containers: Dockerize Appium Tests </b><br />Srinivasan Sekar – Senior Consultant, ThoughtWorks<br /><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/jGW6ycW_tTQ" width="560"></iframe> <a href="https://youtu.be/jGW6ycW_tTQ">https://youtu.be/jGW6ycW_tTQ</a><br /><b><u><br /></u></b><b><u>Virtual Machine vs Docker:</u></b><br /><br />VMs use a Hypervisor to simulate hardware, with each application needing its own guest operating system. Docker is more lightweight, with only a Docker Engineer and the operating system between the apps and the infrastructure. You can spin up three or four thousand containers up in seconds. A virtual machine can take five or six minutes to spin up.<br /><br />We’ve <a href="http://www.tjmaher.com/search?q=docker" target="_blank">tinkered with Docker </a>before in this blog, but haven’t really gone beyond that. Docker is an open platform for developing, shipping, and running applications.  As we’ve seen, Docker is a client / server architecture, where the client can do:<br /><br /><ul><li><i>docker build</i></li><li><i>docker pull</i></li><li><i>docker run</i></li></ul><br />This interacts with the REST API on DOCKER_HOST to create a docker image. With this docker image, we can spin up thousands of images. <br /><br />The challenge when mobile testing is that there are so many devices you need to test on, it takes a long time to execute a test, it takes time to get good test coverage, and a few of the tests may themselves be unreliable.<br /><br />The tests may work fine on Samsung Galaxy 6, but do the tests run on the earlier Marshmallow operating system?<br /><br />Appium is an open source, cross-platform test automation tool for native, hybrid and mobile web are mobile apps. Installing earlier versions of Appium was a pain. It also has many dependencies: Node.js, Java, Apple Developer tools, Xcode, Android, setup, etc. You needed to install all the emulators. So much configuration!<br /><br />What if you could download one Docker image which had everything already set up, and could be ready to start developing products within seconds? A Docker Container has an application plus all dependencies, libraries, other binaries, and configuration files needed to run it all in one package. The container is a portable runtime environment. Imagine if you could even put emulators in the containers? If you want to see what is running, have a <a href="https://www.realvnc.com/" target="_blank">RealVNC</a> server up and running to see what is happening in the container.<br /><br />All the instructions are set up in a <b>DockerFile</b>. You can do this for both Android and IOS, though to do iOS you need a Mac for development. It sizes 1.8 GB for a docker image to be up and running.<br /><br /><i>Some of the sample code, from what I could see...</i><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> Public class DockerizeAppium extends BaseAndroidTest {  <br />   <br /> @Test  <br /> public void horizontalSwipingTest() trows Exception {  <br />   login();  <br />   driver.findElementByAcessibilityId(“slider”).click  <br />   MobileElement slider = [MobileElement];  <br />   driver.findElementByAccessibilityID( “slider”);  <br />   Dimension size = slider.getSize();  <br />   <br />   TouchAction swipe = new TouchAction(driver).press(slider, 0, size.height / 2).waitAction(2000)  <br />   .moveTo(slider, size.width / 2, size.height / 2).release();  <br />   swipe.perform;  <br />   <br /> private void login() {  <br />   New WebDriverWait(driver…  <br /></code></pre><br /><br />Appium can be running in the Docker machine. You give IP address of the Docker machine where the tests are and point them to the environment.<br /><br />Let’s say we want to run Docker and mount a device so that the test can be run on a real Android device.  <br /><i>docker run -d -P —privileged -v /dev/bus/usb1/dev/hub/usb —name appium appium </i><br /><br />In his example, to find what port it is running: <br /><br /><i>Docker ps -a</i><br /><br />==&gt; Port 0.0.0.0:32769-&gt;4723, 0.0.0.0.:32768-&gt;5900/tcp<br /><br />docker-machine ip <br /><br />==&gt; 192.168.99.103<br /><br />We need to copy the React Native app: <br /><i>docker cp /Users/ssekar/IdeaProjects/DockerAppium/VodQA.apk Appium:/opt </i><br /><i>docker logs Appium </i><br /><br />You can pull up the logs to see what is happening in the Docker container, such as if Appium is running. You can also switch inside the container.<br /><br /><i>docker exec -t appium /bin./sh </i><br /><br />Any real devices connected?<br /><br /><i>#adb devices // No, none.</i><br /><i>#exit</i><br /><br />Let’s say we want to switch from Android to IOS: <br />Remove the Appium docker container: <i>docker rm -f appium </i><br /><br />Docker has also Docker Compose where you can group up things such as:<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> appium-android:  <br />   image: appium  <br />   privileged: true  <br />   container_name: appium  <br />   volumes:  <br />     - /dev/bus/usb:/dev/bus/usb  <br />     - ./VodQA.apk:/opt/VodQA.apk  <br />   ports:  <br />      - 4723:4723  <br /> java-maven:  <br />   image: javamvn  <br />   container_name: javamvn  <br />   volumes:  <br />     - ./:/home  <br />   command: mvn clean test  <br />  links:  <br />   - appium-android: localhost  </code></pre><br />This means the tests are also containerized. Another container has java maven. <br /><br />Now, we just need: <br /><i>docker-compose up </i><br /><br />It runs two containers: <br /><br /><ul><li>Creating Appium</li><li>Creating javamvn</li><li>Attaching to Appium, javamvn</li><li>It downloads all dependencies</li></ul><br /><br />References:<br /><br /><ul><li><a href="https://github.com/appium/appium-docker-android/tree/master/Appium">https://github.com/appium/appium-docker-android/tree/master/Appium</a></li><li><a href="https://github.com/appium/appium-docker-android">https://github.com/appium/appium-docker-android</a></li><li><a href="https://github.com/SeleniumHQ/docker-selenium">https://github.com/SeleniumHQ/docker-selenium</a></li><li><a href="https://github.com/appium">https://github.com/appium</a></li><li><a href="https://github.com/SrinivasanTarget/awesome-appium">https://github.com/SrinivasanTarget/awesome-appium</a></li><li><a href="https://github.com/saikrishna321/AppiumTestDistribution">https://github.com/saikrishna321/AppiumTestDistribution</a></li></ul><br /><br /><br /><br />Happy Testing! <br /><br />-T.J. Maher<br /><a href="https://twitter.com/tjmaher1" style="color: #1155cc;" target="_blank">Twitter</a>&nbsp;|&nbsp;<a href="https://www.linkedin.com/in/tjmaher1" style="color: #1155cc;" target="_blank">LinkedIn</a>&nbsp;|&nbsp;<a href="https://github.com/tjmaher" style="color: #1155cc;" target="_blank">GitHub</a><br /><br /><i>// Sr. QA Engineer, Software Engineer in Test, Software Tester since 1996.<br />// Contributing Writer for&nbsp;<a href="http://techbeacon.com/contributors/thomas-maher" style="color: #1155cc;" target="_blank">TechBeacon.</a><br />// "Looking to move away from manual QA?&nbsp;Follow&nbsp;<a href="http://www.tjmaher.com/" style="color: #1155cc;" target="_blank">Adventures in Automation</a>&nbsp;on <a href="https://www.facebook.com/AdventuresInAutomation/" target="_blank">Facebook</a>!"</i>