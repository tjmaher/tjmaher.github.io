---
layout: post
title: 'Playing with Protractor: Testing an AngularJS application with Protractor,
  Jasmine, and JavaScript'
date: '2016-09-11T01:05:00.001-04:00'
author: T.J. Maher
tags:
- WebDriver
- AngularJS
- Protractor
modified_time: '2016-09-13T18:07:10.690-04:00'
thumbnail: https://4.bp.blogspot.com/-vzwxwEgozfY/V9TUZESqp6I/AAAAAAAALWQ/L5XAm00Bc5MlkWfVFyFukP-2L80x43gRQCLcB/s72-c/angular.png
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-9063819873717393073
blogger_orig_url: http://www.tjmaher.com/2016/09/playing-with-protractor-testing.html
---

Yesterday was a lot of fun! I was given an automation development assignment a few days ago in preparation for an upcoming job interview:<br /><br />Using any technology I’d like, as long as it could be run using freely available software, after filling out a questionnaire given on the company's healthcare web app and writing a test journal post, I was to produce automated checks for the following:<br /><ul><li>An “Assessment Complete” badge appears on the dashboard</li><li>The journal entry created is present on the journal page.</li><li>The personality type displayed on the dashboard matches the one given to me in the assessment</li></ul><div>What the instructions <i>didn't</i> say was that before each test, you had to navigate a login procedure:</div><div><a name='more'></a><br /></div><div><ul><li>Go to the first login page. Enter your email. Wait for the animation to be done, then select the Continue button.</li><li>On the next page, wait for another animated graphic to load.&nbsp;</li><li>After loading, enter the given password.&nbsp;Wait for the animation to be done, then select the Login button.</li><li>Only <i>then </i>can you navigate to the dashboard.&nbsp;</li></ul><div>Hrm, this was going to be trickier than it had initially sounded...</div></div><h2><br /><i>My First Attempt</i>: Selenium WebDriver with Java and JUnit 4</h2><div><br /></div><div>I immediately started sketching out how to assemble the framework:</div><div><ul><li>Code the assignment in Selenium WebDriver in Java using JUnit 4 as a testing framework, exactly as I have been doing these past few years.&nbsp;</li><li>I was going to place the tests in a Test Class, the common elements of the test in a TestActions class, the web elements in PageObjects, and wrap all Selenium WebDriver elements in try / catch blocks ... but that would take time... &nbsp;</li></ul><div>After checking with the company, I found out that they were just looking for basic Selenium coding...<br /><br />... Can I select web elements? Navigate a site? They were looking for things like that. Proof that I could get <i>something</i> written on the first day.<br /><br />I hacked out something in a couple of hours. There was minor difficulty since it was a slow-loading site, and I had to wait for some animations to load up, and some other elements were nested deeply in the DOM, where I had to find the selector of the parent element, and then go into the secondary element, but it was fun to play around with <a href="https://www.mozilla.org/" target="_blank">Firefox</a>'s plugins <a href="http://getfirebug.com/" target="_blank">Firebug</a> and <a href="https://addons.mozilla.org/en-US/firefox/addon/firepath/" target="_blank">Firepath</a>.<br /><br />I submitted the test code to the company ahead of the deadline, but I realized it wasn't as elegant a solution as I could have made it. I went back to the app, and looked at the source code... what was this? ... AngularJS? I've heard of that JavaScript framework, but never had come across it before...<br /><br />... I wondered... was there a special way to test AngularJS applications?<br /><br /><h2><i>My Second Attempt</i>: Protractor, JavaScript, and Jasmine</h2></div></div>It took me seconds on Google to find out that AngularJS applications were built to be tested: unit tested, component tested, and browser tested!<br /><h3 style="text-align: center;">AngularJS</h3><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-vzwxwEgozfY/V9TUZESqp6I/AAAAAAAALWQ/L5XAm00Bc5MlkWfVFyFukP-2L80x43gRQCLcB/s1600/angular.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="https://4.bp.blogspot.com/-vzwxwEgozfY/V9TUZESqp6I/AAAAAAAALWQ/L5XAm00Bc5MlkWfVFyFukP-2L80x43gRQCLcB/s400/angular.png" width="375" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i>Website:&nbsp;<a href="https://angularjs.org/">https://angularjs.org/</a></i></td></tr></tbody></table><br /><ul><li><b>Official Website</b>:&nbsp;<a href="https://angularjs.org/">https://angularjs.org/</a></li><li><b>GitHub Site</b>:&nbsp;<a href="https://github.com/angular/angular.js">https://github.com/angular/angular.js</a></li><li><b>Official Tutorial</b>: The PhoneCat app:&nbsp;<a href="https://docs.angularjs.org/tutorial">https://docs.angularjs.org/tutorial</a></li><li><b>Free course</b>:&nbsp;<a href="https://www.codeschool.com/pages/angular-1-vs-2">https://www.codeschool.com/pages/angular-1-vs-2</a></li></ul><div><br /></div><h3 style="text-align: center;">Protractor</h3><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-FpJ7pWHCtjo/V9TUZLclkjI/AAAAAAAALWY/aS0frSPSrNwyIGDMVmJZk4gW1hlTbwEDACEw/s1600/protractor.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="311" src="https://4.bp.blogspot.com/-FpJ7pWHCtjo/V9TUZLclkjI/AAAAAAAALWY/aS0frSPSrNwyIGDMVmJZk4gW1hlTbwEDACEw/s320/protractor.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i>Website:&nbsp;<a href="http://www.protractortest.org/">http://www.protractortest.org/</a></i></td></tr></tbody></table><br />Protractor sits on top of the JavaScript binding of Selenium WebDriver. It allows you to code with the ease of JavaScript.<br /><ul><li><b>Official Website</b>:&nbsp;<a href="http://www.protractortest.org/">http://www.protractortest.org/</a></li><li><b>GitHub Site</b>:&nbsp;<a href="https://github.com/angular/protractor">https://github.com/angular/protractor</a></li><li><b>Official Tutorial</b>:&nbsp;<a href="http://www.protractortest.org/#/tutorial">http://www.protractortest.org/#/tutorial</a></li><li><b>Protractor Cheat Sheet</b>:&nbsp;<a href="https://gist.github.com/javierarques/0c4c817d6c77b0877fda">https://gist.github.com/javierarques/0c4c817d6c77b0877fda</a></li></ul><br /><br /><h3 style="text-align: center;">Jasmine</h3><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-A-DRaKkjS6M/V9TZSrl3bxI/AAAAAAAALWw/h2lKlSsq85c4cmqoAgBLni2QLG0dbfSAACLcB/s1600/jasmine.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="315" src="https://1.bp.blogspot.com/-A-DRaKkjS6M/V9TZSrl3bxI/AAAAAAAALWw/h2lKlSsq85c4cmqoAgBLni2QLG0dbfSAACLcB/s320/jasmine.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i>Website:&nbsp;<a href="http://jasmine.github.io/">http://jasmine.github.io/</a></i></td></tr></tbody></table><br />Jasmine allows you to build up tests quickly.<br /><ul><li><b>Official Website</b>:&nbsp;<a href="http://jasmine.github.io/">http://jasmine.github.io/</a></li><li><b>GitHub Site</b>:&nbsp;<a href="https://github.com/jasmine/jasmine">https://github.com/jasmine/jasmine</a></li><li><b>Documentation</b>:&nbsp;<a href="http://jasmine.github.io/2.5/introduction.html">http://jasmine.github.io/2.5/introduction.html</a></li></ul><br />... You may wonder why I always list the GitHub site of an open-source product in these blog entries?<br /><br />This is because I have found that the classes you take are not enough to understand what these tools are doing. The official documentation is not enough, either.<br /><br />You only truly know the product if you can look at the code that created it. There are more methods to find a selector than what is listed in a Selenium WebDriver class. Developers I have worked with don't wait until a training class is available. They look at the docs of a product. They play around with it on their own. They look at the source code that is available, learn how the product really works, and also learn the style of the authors, making them a better coder.<br /><br /><h3 style="text-align: center;">JavaScript</h3><br /><b>JavaSscript CodeSchool Site</b>:&nbsp;<a href="https://www.javascript.com/">https://www.javascript.com/</a><br /><br /><ul><li><b>JavaScript Road Trip</b>:&nbsp;<a href="https://www.codeschool.com/courses/javascript-road-trip-part-1">https://www.codeschool.com/courses/javascript-road-trip-part-1</a></li><li><b>JavaScript Resources</b>: <a href="https://www.javascript.com/resources">https://www.javascript.com/resources</a></li></ul><br /><br /><h2>How to Set Up Your System To Run Protractor Tests</h2><br />Note: You can easily set up Protractor on Mac, Linux, and Windows environments. I set it up on my Windows 10 machine at home ... and I am utterly, utterly surprised it worked out. <br /><br /><ul><li>Set up <b>Node.js</b> on your system: <a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a>&nbsp;</li><li>We will be using the Node Package Manager (<b>npm</b>) to install tools</li><li>Open up a Command Line tool such as Terminal</li><li>Install <b>Protractor</b>: <i>npm install -g protractor</i></li><li>Make sure that Protractor is working: <i>protractor --version</i>&nbsp;</li><li>Update WebDriver Manager: <i>webdriver-manager update</i></li><li>Start up a Selenium server: <i>webdriver-manager start</i></li><li>See if the Selenium server is running: Go to <a href="http://localhost:4444/wd/hub">http://localhost:4444/wd/hub</a> in a browser and see if the UI is displayed. This acts like a Selenium Grid.</li></ul>Protractor will automatically install Jasmine, a BDD tool used to write the tests.&nbsp;Learn more about Jasmine: <a href="http://jasmine.github.io/2.5/introduction.html">http://jasmine.github.io/2.5/introduction.html</a> ...<br /><br />It's slightly different than TestNG or JUnit. Jasmine handles all "asserts" as "expects", but it is pretty similar.<br /><br /><h2>Protractor Code Samples</h2><br />I produced two files for the automated tests: A <b>conf</b> file that stored the configurations, and a <b>spec</b> file which specified the test. Here's what I came up with:<br /><br /><b><u>Conf.js</u></b><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> // conf.js  <br /> exports.config = {  <br />  framework: 'jasmine',  <br />  seleniumAddress: 'http://localhost:4444/wd/hub',  <br />  specs: ['spec.js']  <br /> }  <br /></code></pre><br />The test code I came up with below, I changed the username, password, and the URL the test is connecting to, just to be safe. Heck, I don't want you actually changing my personality test results!<br /><br /><b><u>Spec.js</u></b><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">1:  describe('Fake Site Test', function() {  <br />2:    <br />3:   var stressProfileUrl = "https://fake-site/dashboard#/stress-profile";  <br />4:   var journalUrl = "https://fake-site/dashboard#/journal";  <br />5:    <br />6:   function navigateToLoginPageAndLoginAsTJ(){  <br />7:    browser.get('https://fake-site/auth/login');  <br />8:    <br />9:    expect(browser.getTitle()).toEqual('Login | Fake Site');  <br />10:     <br />11:    element(by.model('login_data.email')).sendKeys('test@test.com');  <br />12:    element(by.css('.animate-switch.ng-scope &gt; button')).click();  <br />13:    <br />14:    var EC = protractor.ExpectedConditions;  <br />15:    var passwordGraphic = element(by.css("[src='/symfony/img/auth/password.png']"));  <br />16:    browser.wait(EC.visibilityOf(passwordGraphic), 20);  <br />17:    <br />18:    element(by.model('login_data.password')).sendKeys('12345');  <br />19:    element(by.css('.animate-switch.ng-scope &gt; button')).click();  <br />20:    <br />21:    expect(browser.getTitle()).toEqual('My Dashboard | Fake Site');  <br />22:   }   <br />23:    <br />24:   it('should have the Assessment Complete badge and "Problem Solver" on Stress Profile, and the Test Entry in the journal', function() {  <br />25:    navigateToLoginPageAndLoginAsTJ();  <br />26:    browser.get(stressProfileUrl);  <br />27:    <br />28:    var badgeAssessmentElement = element(by.css("[alt='complete badge']"));  <br />29:    expect(badgeAssessmentElement.isDisplayed());  <br />30:    <br />31:    var personalityNameElement = element(by.css(".personality &gt; .personality-box &gt; h3 &gt; .ng-binding"));  <br />32:    expect(personalityNameElement.getText()).toBe('Problem Solver');  <br />33:    <br />34:    browser.get(journalUrl);  <br />35:    <br />36:    var listHeaders = element.all(by.css('p.journal-entry-txt.ng-binding')).each(function(element, index) {  <br />37:     element.getText()   <br />38:    });  <br />39:    <br />40:    var isTestHeaderDisplayed = false;  <br />41:    var testHeader = 'This is a test';  <br />42:    <br />43:    for (i = 0; i &lt; listHeaders; i++) {  <br />44:     if (listHeaders.get(i) === testHeader) {  <br />45:      isTestHeaderDisplayed = true;  <br />46:      break;  <br />47:     }  <br />48:    }  <br />49:    <br />50:    expect(isTestHeaderDisplayed);  <br />51:    <br />52:   });  <br />53:  });  <br /></code></pre><br />Notice the little differences between Selenium WebDriver / Java / JUnit and Protractor / JavaScript / Jasmine. WebDriver / Java would use:<br /><br /><ul><li>Assert.assertEquals, instead of expect</li><li>WebDriverWait(driver, 20).until(ExpectedConditions.visibilityOfElementLocated(By.cssSelector(...)</li><li>WebElement passwordTextbox = driver.findElement(By.id("password"));</li><li>Assert.assertTrue(driver.getCurrentUrl().contains("journal"));</li><li>List&lt;WebElement&gt; journalEntries = driver.findElements(By.cssSelector("p.journal-entry-txt.ng-binding"));</li></ul><br /><h2>How to Run The Tests</h2><br /><ul><li>Create a new directory</li><li>Place conf.js and spec.js in the new directory&nbsp;</li><li>Open the Command Line and go that directory.</li><li>Run the test: <i>protractor conf.js</i></li></ul><br />... Of course, the test will error out. I faked the URL, username, and password, to give the company a bit of privacy.<br /><br /><h2>Results of the Test</h2><br />C:\Users\tmaher\Documents\code\MeQ&gt;protractor conf.js<br />[00:44:37] I/hosted - Using the selenium server at http://localhost:4444/wd/hub<br />[00:44:37] I/launcher - Running 1 instances of WebDriver<br />Started<br />..<br /><br />1 spec, 0 failures<br />Finished in 16.464 seconds<br />[00:44:57] I/launcher - 0 instance(s) of WebDriver still running<br />[00:44:57] I/launcher - chrome #01 passed<br /><br /><h2>Where to Go From Here?&nbsp;</h2>Down the line, maybe later I can build off this with:<br /><br /><b>The Grunt Protractor Runner:</b> <a href="https://www.npmjs.com/package/grunt-protractor-runner">https://www.npmjs.com/package/grunt-protractor-runner</a> as a way to run tools from the command line.<br /><br /><ul><li>If I could figure out how to stand up a Jenkins server, a job normally handled by DevOps, I could config a Jenkins job to use Grunt to make tests like these run as part of a Continuous Integration suite. The tests could run once per hour, just after code is deployed, or overnight at a certain time.&nbsp;</li></ul><br /><b>Page Objects</b>: <a href="https://github.com/angular/protractor/blob/master/docs/page-objects.md">https://github.com/angular/protractor/blob/master/docs/page-objects.md</a>&nbsp;... Group elements on a page in the same class, to have better organized code.<br /><br />Until Then, Happy Testing! <br /><br /><div class="toc-section" id="toc-section"><b>Playing With Protractor:</b><br /><ul><li><b>Part One:</b> <a href="http://www.tjmaher.com/2016/09/playing-with-protractor-testing.html">My first exposure to an AngularJS web app: Testing using Protractor, Jasmine, and JavaScript</a></li><li><b>Part Two:</b>&nbsp; <a href="http://www.tjmaher.com/2016/09/playing-with-protractor-learning.html">Learning AngularJS with the PhoneCat Tutorial App: Installation, Setup, and Running Tests</a></li><li><b>Part Three</b>:&nbsp;<a href="http://www.tjmaher.com/2016/09/playing-with-protractor-complexities-of.html">The complexities of testing JavaScript frameworks, according to Vojtěch Jína, creator of Karma Test Runner for AngularJS</a></li></ul></div><br /><br />-T.J. Maher<br />Sr. QA Engineer<br /><br /><i>// Software QA Engineer since 1996.<br />// Working with Selenium WebDriver since 2014.  <br />// Follow Adventures in Automation and Like us on <a href="https://www.facebook.com/AdventuresInAutomation/">Facebook</a>! </i>