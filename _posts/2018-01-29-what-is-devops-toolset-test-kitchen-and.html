---
layout: post
title: What Is the DevOps toolset "Test Kitchen" and Where Did It Come Come from?
  Fletcher Nicol at ChefConf 2014
date: '2018-01-29T07:00:00.000-05:00'
author: T.J. Maher
tags:
- Chef
- DevOps
- KitchenCI
modified_time: '2018-01-29T07:46:27.468-05:00'
thumbnail: https://i.ytimg.com/vi/YzlCHAbJ7KM/default.jpg
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-3175927972127537554
blogger_orig_url: http://www.tjmaher.com/2018/01/what-is-devops-toolset-test-kitchen-and.html
---

When learning and investigating a new open-source tool or technology, I find YouTube to be an amazing resource!<br /><br />Beyond the many tutorials, presentations, and instructional videos, I try to see how the creators of the tool introduces and talks about it to the open-source community. What was the creator trying to achieve? What problem was to be solved? And, most importantly, how can I take the creator's message and transfer it to the work that I am doing?<br /><br />Right now, I'm trying to get up to speed on <b>Test Kitchen</b> &lt;&nbsp;<a href="http://kitchen.ci/" target="_blank">kitchen.ci</a>,&nbsp; <a href="https://twitter.com/kitchenci" target="_blank">@kitchenci</a>&nbsp;<span id="goog_1725328508"></span><a href="https://draft.blogger.com/"></a><span id="goog_1725328509"></span>&gt;, the product we use at work, combined with <a href="http://chef.io/" target="_blank">Chef.io</a>, to automate spinning up and tearing down different Amazon Web Services environments.<br /><br />With the "<a href="https://learn.chef.io/#/" target="_blank">Learning Chef Rally</a>", it is going to take me a few weeks to finally get to the part I need, learning exactly how the DevOps tool spins up environments, so I was also seeking alternate sources to tide me over.<br /><br />Luckily, I found this, introduced at ChefConf 2104, a conference about Chef...<br /><br /><b>#ChefConf 2014: Fletcher Nichol, "Test Kitchen: One Year Later and the Future</b><br /><div><i>Fletcher Nicol, 2014</i><br /><iframe allow="autoplay; encrypted-media" allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/YzlCHAbJ7KM" width="560"></iframe><br /><a href="https://youtu.be/YzlCHAbJ7KM" target="_blank"><i>https://youtu.be/YzlCHAbJ7KM</i></a><br /><br /><a name='more'></a><br /><br />"After one year of active development and real world use, Test Kitchen 1.0 was released on December 1, 2013. And this is only the beginning. In this session we will cover an introduction to Test Kitchen, its ecosystem, some common (and crazy) usage patterns in the wild, and ways to extend and bend the framework to your will. If you want a good insight into where Test Kitchen is going, then this talk is for you".<br /><br />According to Fletcher, Test Kitchen is "a test harness tool to execute your configured code on one or more platforms in isolation". It helps you run Chef code in isolation.&nbsp;</div><div><br /></div><div><b>Initial Goals for Test Kitchen 1.0:&nbsp;</b></div><div><ul><li>Simple workflow.&nbsp;</li><li>Declarative static configuration, so they went with a YAML file instead of the Ruby code that sets it up. They didn't want programming, necessarily to do set up. ( <a href="https://learn.getgrav.org/advanced/yaml" target="_blank">Care to read way too much on what a YAML file is?</a> )</li><li>Speed in development</li><li>Optimizes for freshness of code, such as deleting Chef code and re-installing it so that there aren't any caching problems.&nbsp;</li></ul><div>"Kitchen converges with provisioners and runs specific suites on target platforms called instances using drivers".&nbsp;</div></div><div><ul><li><b>Platform</b>: Operating system or target environment.&nbsp;</li><li><b>Suite</b>: A Chef configuration, a run-list and node attributes</li><li><b>Instance</b>: A platform&nbsp;+ suite with auto-generated name</li><li><b>Driver</b>: Implementation of instance actions: create, converge, setup, verify, destroy. Need one? Write one! They are Ruby Gem plugins.&nbsp;</li><li><b>Provisioner</b>: Implementation of infrastructure automation tool or framework. Runs your Chef code. Yes, you can write one... but in 2014 Fletcher was not quite sure if you should yet.</li><li><b>Busser</b>: A Ruby gem, prepares instances for test suites and runs them.&nbsp;</li></ul></div><div>Fletcher pointed to the <b>Kitchen.ci Getting Started guide</b>:&nbsp;<a href="https://kitchen.ci/docs/getting-started" target="_blank">https://kitchen.ci/docs/getting-startedhttps://kitchen.ci/docs/getting-started</a>. Currently it walks people through Installing, Creating a Cookbook, the .kitchen.yml, writing a recipe, manually verifying it, writing a test, adding a platform, adding a feature, adding a&nbsp;suite, a test, adding a&nbsp;recipe, etc.&nbsp;</div><div><br /></div><div>He also talked about Usage Patterns:</div><div><ul><li>Detangling cookbook dependencies. For example, when you run recipes by themselves, you might find that a cookbook runs fine on one Linux distribution but not on another. Java never was explicitly installed, so code on CentOS did not run.&nbsp;</li><li>Test Chef upgrades: Test to see if your stuff still works. You can test different versions of Chef Omnibus.&nbsp;</li></ul><div>Tip:</div></div><div><ul><li>Don't type out very long instance names. There is <b>fuzzy matching</b>, so you can do "kitchen destroy". It will either follow the exact name, the regular expression. No parameter? It will destroy all. "kitchen list all" and "kitchen list" is the same command. How does this work? It is being passed in as a Ruby regular expression.&nbsp;</li></ul><div>Biggest takeaway, Fletcher was excited about back in 2014?&nbsp;</div></div><div><ul><li><b>kitchen diagnose</b>: "Originally used for support. It makes all implicit configuration explicit. Kitchen gives you a shopping list of configuration tunables that you can mess with". If you find yourself in YAML Hell, not sure what is being loaded, use this command.&nbsp;</li><li>kitchen diagnose --loader</li></ul></div><div>Fletcher also mentioned the <b>Chef Zero Provisioner</b>, written by John Keiser, "the fakest Chef server ever". Runs in Ruby, spins up quickly, and is great for testing! There is also the chef_zero, the fakest chef-client run. It supports "data bags encrypted secrets, environments, nodes &amp; clients".</div><div><br /></div><div>That's it for now! Happy Testing!<br />-T.J. Maher<br />Sr. QA Engineer, Software Engineer in Test<br />Meetup Organizer, <a href="http://bit.ly/mot_boston" target="_blank">Ministry of Testing - Boston</a><br /><br /><a href="https://twitter.com/tjmaher1">Twitter</a>&nbsp;| <a href="http://bit.ly/tj_youtube" target="_blank">YouTube</a> |&nbsp;<a href="https://www.linkedin.com/in/tjmaher1" target="_blank">LinkedIn</a>&nbsp;| <a href="http://bit.ly/tj_techbeacon" target="_blank">Articles</a></div>