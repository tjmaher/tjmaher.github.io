---
layout: post
title: 'Automate Amazon: Initializing Login and Cart'
date: '2016-01-06T19:15:00.000-05:00'
author: T.J. Maher
tags:
- code examples
- Java
- WebDriver
- test framework
modified_time: '2016-04-29T07:44:40.450-04:00'
blogger_id: tag:blogger.com,1999:blog-3868566217808655382.post-9112391319743402945
blogger_orig_url: http://www.tjmaher.com/2016/01/automate-amazon-initializing-login-and.html
---

<i>This post is sixth of a series of nine. Need to go <a href="/2015/12/next-week-automating-amazon-how-i-am.html" target="_blank">back to the beginning</a>?</i><br /><br>While drafting the tests to handle adding products to the shopping cart, I came across two problems:<br /><br /><ul><li>I kept on on finding that I was logged into my personal Amazon.com account instead of the test account.&nbsp;</li><li>From one session to the next, Amazon kept remembering what I had in my shopping cart the test before.&nbsp;</li></ul><div>Before the test is run, we need to initialize the login session, and clear all items found in the cart.<br /><br /><a name='more'></a><br /><b>Please Note</b>: &nbsp;Using the GUI is the WORST possible way to initialize the cart or the login. It is far better to use some behind-the-scenes method the automated test could call in the&nbsp;@BeforeClass method to be used during setup of the test.<br /><br />We are writing this functionality this way only because I can't think of any other way besides do it how I have outlined. Have a better way? Thoughts? Please add to the comments.<br /><br />I haven't been an automated tester for long. Feel free to give me pointers!</div><br /><h3>What our Directory Structure Will Look Like</h3><br />For this blog entry, we will be expanding upon the what we already had, so the directory structure will remain the same, except for a new page object called ShoppingCartPage.<br /><br /><b>src/test/java</b><br /><ul><li>actions</li><ul><li>OrderActions</li></ul><li>base</li><ul><li>LoadProperties</li></ul><li>enums</li><ul><li>Products</li><li>Url</li></ul><li>pages</li><ul><li>HomePage</li><li>SignInPage</li><li>ProductPage</li><li>ShoppingCartPage</li></ul><li>pojo</li><ul><li>Book</li></ul><li>properties</li><ul><li>user.properties</li></ul><li>testcases</li><ul><li>PurchaseOrderTest</li></ul><li>utils</li><ul><li>CommonUtils</li><li>DriverUtils</li></ul></ul><h3>Initialize the Login</h3><div>Initializing the Login is simple. When I am signed into&nbsp;<a href="http://www.amazon.com/">http://www.amazon.com/</a>, I see on the horizontal navigation bar, "Hello, Thomas / Your Account". When you hover your cursor over that area, and scroll to the bottom, you can see "Not Thomas? Sign Out".&nbsp;</div><div><br /></div><div>By clicking on the link, you are directed to <a href="http://www.amazon.com//gp/flex/sign-out.html">http://www.amazon.com//gp/flex/sign-out.html</a>. Before you start your test, you can go to this link and whether or not you are logged in, you can sign out.&nbsp;</div><div><br /></div><div>With this information, we can update our PurchaseOrderTest, our OrderActions, and Url enum.</div><div><br /></div><div><b>PurchaseOrderTest Addition:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> orderActions.initializeLogin();  <br /></code></pre><b><br /></b><b>OrderActions Addition:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   public void initializeLogin(){  <br />     System.out.println("INITIALIZING: Signing out, if needed.\n");  <br />     signOut();  <br />   }  <br />   public void signOut(){  <br />     HomePage homePage = new HomePage();  <br />     homePage.signOutWithSignOutLink();  <br />   }  <br /></code></pre><br /><b>HomePage Addition:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   public void signOutWithSignOutLink(){  <br />     String url = Url.BASEURL.getURL() + Url.SIGNOUT.getURL();  <br />     navigateToURL(url);  <br />   }  <br /></code></pre><br /><b>Url Enum now looks like:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> public enum Url {  <br />   PRODUCT_SECTION("/gp/product"),  <br />   BASEURL("http://www.amazon.com"),  <br />   SIGNOUT("/gp/flex/sign-out.html");  <br />   String url;  <br />   Url(String url){  <br />     this.url = url;  <br />   }  <br />   public String getURL() {  <br />     return url;  <br />   }  <br /> }  <br /></code></pre><br />... Could this be done all in one method? Definitely! But by abstracting things out, it makes the code a lot easier to read, and a lot easier to find what classes you need to add to.<br /><br /><h3>Initialize the Shopping Cart</h3></div><div>Initializing the Shopping Cart is a bit more complex. It involves:<br /><br /><ul><li><b>Check if the Shopping Cart icon already lists '0'</b>: Looking at the shopping cart icon in the horizontal navigation bar, you can see that the value isn't a graphic. It is just a number in a string that we can get and check if the value is already '0'.</li><li><b>If not '0', go to the Shopping Cart</b>: Click on the Shopping Cart icon to go to the Shopping Cart.&nbsp;</li><li><b>Get All Delete Buttons</b>: Gather up all the web elements that are a delete button.&nbsp;</li><li><b>Click all Delete Buttons</b>: One by one, get the delete button, and click on it, removing the item from the cart.</li></ul><div>If we wanted to make this more robust, we could check that at the end of the process that the cart is empty. With this first pass, we are going to leave it as is.&nbsp;</div><div><b><br /></b></div><div><b>PurchaseOrderTest Addition:</b></div><div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> @Test()  <br />   public void test_createPurchaseOrderForSingleProduct(){   <br />     String username = LoadProperties.user.getProperty("tester23.username");  <br />     String password = LoadProperties.user.getProperty("tester23.password");  <br />     OrderActions orderActions = new OrderActions();  <br />     orderActions.initializeLogin();  <br />     orderActions.navigateToHomePage();  <br />     orderActions.loginAs(username, password);  <br />     orderActions.initializeCart();  <br /> }  <br /></code></pre></div><div><br /><br /><ul><li>First, we make sure that all users are logged out.</li><li>Then, we log in with our test user.</li><li>We navigate to the home page (http://www.amazon.com/)</li><li>We use the LoginAs method to log in.&nbsp;</li><li>Once we are logged in, we can use the initializeCart method in OrderActions.</li></ul></div><div><br /><b>OrderActions Additions:</b></div><div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   public void initializeCart(){  <br />     System.out.println("INITIALIZING: Deleting all Items in Cart.\n");  <br />     deleteAllItemsIfAnyFromCart();  <br />   }  <br />   public void deleteAllItemsIfAnyFromCart(){  <br />     HomePage homePage = new HomePage();  <br />     ShoppingCartPage shoppingCartPage = new ShoppingCartPage();  <br />     String itemsInCart = homePage.getNumberOfItemsListedInShoppingCartIcon();  <br />     if (!itemsInCart.equals("0")){  <br />       homePage.selectShoppingCartIcon();  <br />       shoppingCartPage.deleteAllItemsInCart();  <br />     } else {  <br />       System.out.println("\t* There are already '0' items in the Shopping Cart.");  <br />     }  <br />   }  <br /></code></pre></div><div><br /></div><div><br /><b>HomePage, what it now looks like:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> public class HomePage extends CommonUtils {  <br />   private final By YOUR_ACCOUNT = By.id("nav-link-yourAccount");  <br />   private final By SHOPPING_CART_ICON = By.cssSelector("#nav-cart");  <br />   private final By SHOPPING_CART_COUNT = By.cssSelector("#nav-cart &gt; #nav-cart-count");  <br />   public HomePage(){  <br />   }  <br />   public void navigateToHomePage() {  <br />     String url = Url.BASEURL.getURL();  <br />     System.out.println("Navigating to Amazon.com: " + url);  <br />     navigateToURL(url);  <br />   }  <br />   public void navigateToSignInPage(){  <br />     System.out.println("HOME_PAGE: Selecting [YOUR_ACCOUNT] in navigation bar.");  <br />     scrollToThenClick(YOUR_ACCOUNT);  <br />     System.out.println("HOME_PAGE: Navigating to the SIGNIN_PAGE.\n");  <br />   }  <br />   public void signOutWithSignOutLink(){  <br />     String url = Url.BASEURL.getURL() + Url.SIGNOUT.getURL();  <br />     navigateToURL(url);  <br />   }  <br />   public void selectShoppingCartIcon(){  <br />     click(SHOPPING_CART_ICON);  <br />   }  <br />   public String getNumberOfItemsListedInShoppingCartIcon(){  <br />     return getElementText(SHOPPING_CART_COUNT);  <br />   }  <br /> }  <br /></code></pre><br />Note that the #nav-cart-count is actually a child of #nav-cart. You need to call the main element, what I dubbed the "YOUR_ACCOUNT" web element, then get the child element.<br /><br /><br /></div><div><b>Create a new ShoppingCartPage:</b><br /><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">1:  import java.util.List;  <br />2:  /**  <br />3:   * Created by tmaher on 12/21/2015.  <br />4:   */  <br />5:  public class ShoppingCartPage extends CommonUtils {  <br />6:    private final By SHOPPING_CART_HEADER = By.cssSelector("h1");  <br />7:    private final By DELETE_BUTTONS = By.cssSelector("input[value='Delete']");  <br />8:    private final String SHOPPING_CART_EMPTY_MSG = "Your Shopping Cart is empty.";  <br />9:    public void verifyOnShoppingCartPage(){  <br />10:      String url = getCurrentURL();  <br />11:      System.out.println("SHOPPING_CART_PAGE: Verifying that we are on SHOPPING_CART_PAGE.");  <br />12:      if (!url.contains("cart")){  <br />13:        throw new TestException("ERROR: Not on SHOPPING_CART_PAGE! URL: " + url);  <br />14:      }  <br />15:    }  <br />16:    public String getShoppingCartMessage(){  <br />17:      return getElementText(SHOPPING_CART_HEADER);  <br />18:    }  <br />19:    boolean checkIfShoppingCartHeaderListsEmptyMessage(){  <br />20:      String actualMessage = getShoppingCartMessage();  <br />21:      return (actualMessage.equals(SHOPPING_CART_EMPTY_MSG));  <br />22:    }  <br />23:    public void deleteAllItemsInCart(){  <br />24:      List&lt;WebElement&gt; deleteButtons = getElements(DELETE_BUTTONS);  <br />25:      for ( WebElement button : deleteButtons ){  <br />26:        button.click();  <br />27:      }  <br />28:    }  <br />29:  }  <br /></code></pre><br /></div><div>With the deleteAllItemsInCart method, we can get all the delete button items, and click every one of them in the list.&nbsp;</div><div><br /></div></div><div><b>CommonUtils methods used:</b></div><div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   public List&lt;WebElement&gt; getElements(By Selector) {  <br />     waitForElementToBeVisible(Selector);  <br />     try {  <br />       return _driver.findElements(Selector);  <br />     } catch (Exception e) {  <br />       throw new NoSuchElementException(String.format("The following element did not display: [%s] ", Selector.toString()));  <br />     }  <br />   }  <br /></code></pre></div><br /><br />... In the next blog post we can finally add the product to the Shopping Cart Review page and check that the values are what is expected.<br /><br /><br />Happy coding!<br /><br /><div><br /></div><blockquote class="twitter-tweet" lang="en"><div dir="ltr" lang="en"><a href="https://twitter.com/tjmaher1">@tjmaher1</a> is writing a good 8 part case study of automating a web GUI using <a href="https://twitter.com/hashtag/Java?src=hash">#Java</a> and <a href="https://twitter.com/hashtag/Selenium?src=hash">#Selenium</a> <a href="https://twitter.com/hashtag/WebDriver?src=hash">#WebDriver</a> <a href="https://t.co/ylnF64pFnh">https://t.co/ylnF64pFnh</a></div>— Alan Richardson (@eviltester) <a href="https://twitter.com/eviltester/status/685025609156788224">January 7, 2016</a></blockquote><script async="" charset="utf-8" src="//platform.twitter.com/widgets.js"></script><br><br><b>NEXT: </b><a href="/2016/01/automate-amazon-writing-shopping-cart.html">Writing a Shopping Cart Test</a><br><div class="toc-section" id="toc-section"><b>Automate Amazon</b>: <br /><ul><li><a href="/2015/12/next-week-automating-amazon-how-i-am.html" target="_blank">Introduction</a></li><li><b>Part One:</b>&nbsp;<a href="/2015/12/automate-amazon-development-environment.html" target="_blank">Environment Setup</a></li><li><b>Part Two:</b>&nbsp;<a href="/2015/12/automate-amazon-sketch-out-use-case.html" target="_blank">Sketch Use Case</a></li><li><b>Part Three:</b>&nbsp;<a href="/2015/12/automate-amazon-commonutils-methods-and.html" target="_blank">CommonUtils, methods, exceptions</a></li><li><b>Part Four:</b>&nbsp;<a href="/2015/12/automate-amazon-writing-sign-in-test.html" target="_blank">Write Sign In Test</a></li><li><b>Part Five:</b>&nbsp;<a href="/2016/01/automate-amazon-productenums-and.html" target="_blank">Product Enums and Objects</a></li><li><b>Part Six:</b>&nbsp;<a href="/2016/01/automate-amazon-initializing-login-and.html" target="_blank">Initializing Login and Cart</a></li><li><b>Part Seven:</b>&nbsp;<a href="/2016/01/automate-amazon-writing-shopping-cart.html" target="_blank">Writing Shopping Cart Test</a></li><li><b>Part Eight:</b>&nbsp;<a href="/2016/01/automate-amazon-sketch-of-possible-data.html" target="_blank">Data Driven Tests with TestNG XML</a></li><li><b>Part Nine:</b>&nbsp;<a href="/2016/01/code-review-request-please-automated.html">Code Review Request, please!&nbsp;</a></li><li><b>Source Code:</b>&nbsp;<a href="https://github.com/tjmaher/automate-amazon/">GitHub, T.J. Maher</a></li></ul></div><br /><br> <span style="background-color: white; color: #222222; font-family: &quot;calibri&quot;; font-size: 15.4px; line-height: 21.56px;">-T.J. Maher</span><br /><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;">&nbsp;Sr. QA Engineer, Fitbit</i><br /><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;">&nbsp;Boston, MA</i><br /><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;"><br /></i><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;">// Automated tester for [ 9 ] month and counting!</i><br /><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;"><br /></i><i style="background-color: white; color: #222222; font-family: Calibri; font-size: 15.4px; line-height: 21.56px;">Please note: 'Adventures in Automation' is a personal blog about automated testing. It is not an official blog of&nbsp;<a href="http://www.fitbit.com/" style="color: #888888; text-decoration: none;" target="_blank">Fitbit.com</a>.&nbsp;</i>